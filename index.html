<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esteganografia Basada en Matrius</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Esteganografia Basada en Matrius</h1>
            <p>Amaga missatges secrets en imatges utilitzant la manipulaci√≥ de matrius de p√≠xels</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(0)">üìö Teoria i Guia Manual</button>
            <button class="tab-btn" onclick="switchTab(1)">üõ†Ô∏è Eina d'Encriptaci√≥ i Desencriptaci√≥</button>
        </div>

        <div class="tab-content active" id="tab-theory">
            <h2>Comprendre l'Esteganografia Basada en Matrius</h2>
            
            <h3>Qu√® √©s l'Esteganografia?</h3>
            <p>L'esteganografia √©s la pr√†ctica d'ocultar informaci√≥ dins d'altres dades no secretes. A difer√®ncia del xifratge, que fa que les dades siguin ilegibles, l'esteganografia amaga la mateixa exist√®ncia del missatge. Les imatges digitals s√≥n portadors perfectes perqu√® contenen milers de p√≠xels i les modificacions lleus s√≥n imperceptibles per a l'ull hum√†.</p>

            <h3>Com Funcionen les Matrius de P√≠xels</h3>
            <p>Les imatges digitals s'emmagatzemen com a matrius (quadr√≠cules) de p√≠xels. Cada p√≠xel cont√© informaci√≥ de color codificada com a n√∫meros. En el model de color RGB, cada p√≠xel t√© tres valors que van de 0 a 255:</p>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>R (Vermell)</strong>: 0-255</li>
                <li><strong>G (Verd)</strong>: 0-255</li>
                <li><strong>B (Blau)</strong>: 0-255</li>
            </ul>
            <p>Per exemple, el vermell pur √©s (255, 0, 0), el verd pur √©s (0, 255, 0) i el blau pur √©s (0, 0, 255).</p>

            <div class="example-box">
                <p><strong>Representaci√≥ de matriu d'una imatge 3√ó3:</strong></p>
                <div class="code">P√≠xel[0,0]: (245, 130, 88)   P√≠xel[0,1]: (120, 200, 150)   P√≠xel[0,2]: (90, 110, 200)
P√≠xel[1,0]: (200, 50, 100)   P√≠xel[1,1]: (180, 180, 180)   P√≠xel[1,2]: (75, 95, 210)
P√≠xel[2,0]: (255, 0, 0)      P√≠xel[2,1]: (0, 255, 0)        P√≠xel[2,2]: (0, 0, 255)</div>
                <p>Cada p√≠xel √©s accessible per la seva posici√≥ [fila, columna] a la matriu.</p>
            </div>

            <h3>Codificaci√≥ del Bit Menys Significatiu (LSB)</h3>
            <p>La t√®cnica LSB aprofita el fet que canviar l'√∫ltim bit d'un valor de color produeix una difer√®ncia visual insignificant. Per exemple, canviar el blau de 154 a 155 √©s imperceptible.</p>
            
            <div class="example-box">
                <p><strong>Representaci√≥ bin√†ria:</strong></p>
                <div class="code">154 en binari: 10011010
155 en binari: 10011011  ‚Üê Nom√©s l'√∫ltim bit ha canviat!
                
Difer√®ncia visual: IMPERCEPTIBLE per a l'ull hum√†</div>
                <p>Aquest petit canvi √©s invisible per a l'ull hum√† per√≤ ens permet emmagatzemar dades.</p>
            </div>

            <h3>Aritm√®tica Modular (mod 2) per LSB</h3>
            <p>Utilitzem l'aritm√®tica modular per manipular bits de manera eficient:</p>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>Codificaci√≥:</strong> <code>p√≠xel = (p√≠xel & 0xFE) | bit</code>
                    <ul style="margin-left: 20px;">
                        <li><code>p√≠xel & 0xFE</code>: Operaci√≥ AND bit a bit amb 11111110 que esborra l'√∫ltim bit (el posa a 0)</li>
                        <li><code>| bit</code>: Operaci√≥ OR bit a bit que estableix l'√∫ltim bit al nostre bit de missatge (0 o 1)</li>
                    </ul>
                </li>
                <li><strong>Descodificaci√≥:</strong> <code>bit = p√≠xel & 1</code>
                    <ul style="margin-left: 20px;">
                        <li>Operaci√≥ AND amb 00000001 que extreu nom√©s l'√∫ltim bit del valor del p√≠xel</li>
                    </ul>
                </li>
            </ul>

            <div class="example-box">
                <p><strong>Exemple pr√†ctic d'operacions bit a bit:</strong></p>
                <div class="code">Valor original del p√≠xel: 154 (10011010)
Bit a emmagatzemar: 1

Pas 1 - Esborrar LSB:
  10011010  (154)
& 11111110  (0xFE)
-----------
  10011010  (154 - LSB ja era 0)

Pas 2 - Establir el nou bit:
  10011010
| 00000001  (bit = 1)
-----------
  10011011  (155)

Resultat: 154 ‚Üí 155 (bit 1 emmagatzemat)</div>
            </div>

            <h3>Xifratge amb Aritm√®tica Modular Af√≠</h3>
            <p>Per afegir una capa addicional de seguretat, utilitzem el <strong>xifratge af√≠</strong>, un tipus d'encriptaci√≥ basada en aritm√®tica modular. Abans d'emmagatzemar cada car√†cter a la imatge, el transformem utilitzant la f√≥rmula:</p>
            
            <div class="example-box">
                <p><strong>F√≥rmula d'Encriptaci√≥:</strong></p>
                <div class="code">E(x) = (a¬∑x + b) mod 256

On:
  x = Valor ASCII del car√†cter (0-255)
  a = Multiplicador (ha de ser coprimer amb 256)
  b = Despla√ßament (0-255)
  E(x) = Valor encriptat resultant</div>
            </div>

            <h3>Per Qu√® Funciona el Xifratge Af√≠?</h3>
            <p>El xifratge af√≠ combina dues operacions matem√†tiques:</p>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>Multiplicaci√≥ per 'a'</strong>: Dispersa els valors de forma no lineal</li>
                <li><strong>Suma de 'b'</strong>: Despla√ßa tots els valors una quantitat fixa</li>
                <li><strong>M√≤dul 256</strong>: Assegura que el resultat estigui dins del rang 0-255 (un byte)</li>
            </ul>

            <h3>Condicions Matem√†tiques per al Par√†metre 'a'</h3>
            <p>El valor de 'a' ha de complir condicions espec√≠fiques per permetre la desencriptaci√≥:</p>
            
            <div class="example-box">
                <p><strong>Requisit: MCD(a, 256) = 1</strong></p>
                <p>El M√†xim Com√∫ Divisor entre 'a' i 256 ha de ser 1. Aix√≤ significa que 'a' i 256 s√≥n <strong>coprimers</strong> (no comparteixen factors comuns excepte 1).</p>
                
                <div class="code">Exemples de valors V√ÄLIDS per 'a':
1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25...
(tots els n√∫meros senars que no s√≥n m√∫ltiples de altres factors)

Exemples de valors NO V√ÄLIDS per 'a':
2, 4, 6, 8, 10, 12, 14, 16... (parells - comparteixen el factor 2 amb 256)

Per qu√®? 256 = 2‚Å∏
Qualsevol n√∫mero parell comparteix el factor 2 amb 256
Aix√≤ fa impossible calcular l'invers modular necessari per desencriptar</div>
            </div>

            <h3>C√†lcul de l'Invers Modular</h3>
            <p>Per desencriptar, necessitem trobar l'<strong>invers modular</strong> de 'a' respecte a 256, denotat com a‚Åª¬π. Aquest √©s un n√∫mero tal que:</p>
            
            <div class="example-box">
                <div class="code">a ¬∑ a‚Åª¬π ‚â° 1 (mod 256)

Exemple amb a = 5:
Necessitem trobar a‚Åª¬π tal que (5 ¬∑ a‚Åª¬π) mod 256 = 1

Provant valors:
5 ¬∑ 51 = 255 mod 256 = 255 ‚úó
5 ¬∑ 77 = 385 mod 256 = 129 ‚úó
5 ¬∑ 205 = 1025 mod 256 = 1 ‚úì

Per tant, l'invers modular de 5 √©s 205</div>
                
                <p><strong>M√®tode de c√†lcul:</strong> Utilitzem l'<strong>Algoritme d'Euclides Est√®s</strong> per trobar l'invers modular de forma eficient. Aquest algoritme troba els coeficients de l'identitat de B√©zout.</p>
            </div>

            <h3>F√≥rmula de Desencriptaci√≥</h3>
            <p>Un cop tenim l'invers modular, podem revertir el proc√©s d'encriptaci√≥:</p>
            
            <div class="example-box">
                <p><strong>F√≥rmula de Desencriptaci√≥:</strong></p>
                <div class="code">D(y) = a‚Åª¬π ¬∑ (y - b) mod 256

On:
  y = Valor encriptat
  a‚Åª¬π = Invers modular de 'a'
  b = Mateix despla√ßament utilitzat en l'encriptaci√≥
  D(y) = Valor original desencriptat</div>
            </div>

            <h3>Exemple Complet d'Encriptaci√≥ i Desencriptaci√≥</h3>
            <div class="example-box">
                <p><strong>Par√†metres:</strong> a = 5, b = 8</p>
                <p><strong>Invers modular:</strong> a‚Åª¬π = 205</p>
                <p><strong>Car√†cter a encriptar:</strong> 'H'</p>
                
                <div class="code">Pas 1: Obtenir valor ASCII
'H' ‚Üí ASCII = 72

Pas 2: Aplicar f√≥rmula d'encriptaci√≥
E(72) = (5 ¬∑ 72 + 8) mod 256
E(72) = (360 + 8) mod 256
E(72) = 368 mod 256
E(72) = 112

Pas 3: Emmagatzemar 112 a la imatge (en binari: 01110000)

Pas 4: Per desencriptar, recuperem el valor 112
D(112) = 205 ¬∑ (112 - 8) mod 256
D(112) = 205 ¬∑ 104 mod 256
D(112) = 21320 mod 256
D(112) = 72

Pas 5: Convertir a car√†cter
ASCII 72 ‚Üí 'H' ‚úì Recuperat correctament!</div>
            </div>

            <h3>Per Qu√® Aquest M√®tode √âs Segur?</h3>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>Ocultaci√≥ doble:</strong> El missatge est√† amagat (esteganografia) I encriptat (xifratge af√≠)</li>
                <li><strong>Clau secreta:</strong> Sense con√®ixer els valors de 'a' i 'b', √©s impossible desencriptar</li>
                <li><strong>Espai de claus:</strong> Amb m√∫ltiples valors v√†lids per 'a' (128 opcions) i 256 opcions per 'b', hi ha 32.768 combinacions possibles</li>
                <li><strong>Resist√®ncia a an√†lisi visual:</strong> Els canvis al LSB s√≥n imperceptibles</li>
            </ul>

            <h3>Exemple Manual Pas a Pas: Codificar 'A' amb Encriptaci√≥</h3>
            <div class="example-box">
                <p><strong>Tasca:</strong> Codificar la lletra 'A' en una imatge amb a=5, b=8</p>
                
                <p><strong>Pas 1:</strong> Convertir 'A' a ASCII i encriptar</p>
                <div class="code">Valor ASCII de 'A' = 65
Encriptaci√≥: (5 ¬∑ 65 + 8) mod 256 = 333 mod 256 = 77
77 en binari = 01001101</div>

                <p><strong>Pas 2:</strong> Agafar els valors del canal blau dels primers 8 p√≠xels</p>
                <div class="code">Valors blaus originals (en binari):
P√≠xel 1: 154 (10011010)
P√≠xel 2: 200 (11001000)
P√≠xel 3: 87  (01010111)
P√≠xel 4: 123 (01111011)
P√≠xel 5: 201 (11001001)
P√≠xel 6: 45  (00101101)
P√≠xel 7: 99  (01100011)
P√≠xel 8: 176 (10110000)</div>

                <p><strong>Pas 3:</strong> Reempla√ßar el LSB de cada p√≠xel amb els bits del valor encriptat (77 = 01001101)</p>
                <div class="code">Bits a emmagatzemar: 0 1 0 0 1 1 0 1

P√≠xel 1: 10011010 ‚Üí 10011010 (bit 0) = 154 (sense canvi)
P√≠xel 2: 11001000 ‚Üí 11001001 (bit 1) = 201 (+1)
P√≠xel 3: 01010111 ‚Üí 01010110 (bit 0) = 86 (-1)
P√≠xel 4: 01111011 ‚Üí 01111010 (bit 0) = 122 (-1)
P√≠xel 5: 11001001 ‚Üí 11001001 (bit 1) = 201 (sense canvi)
P√≠xel 6: 00101101 ‚Üí 00101101 (bit 1) = 45 (sense canvi)
P√≠xel 7: 01100011 ‚Üí 01100010 (bit 0) = 98 (-1)
P√≠xel 8: 10110000 ‚Üí 10110001 (bit 1) = 177 (+1)</div>

                <p><strong>Pas 4:</strong> La imatge modificada ara cont√© 'A' encriptada com a 77!</p>
                
                <p><strong>Pas 5:</strong> Per desencriptar:</p>
                <div class="code">Llegir LSBs: 01001101 = 77
Aplicar f√≥rmula inversa: D(77) = 205 ¬∑ (77 - 8) mod 256
D(77) = 205 ¬∑ 69 mod 256 = 14145 mod 256 = 65
ASCII 65 = 'A' ‚úì</div>
            </div>

            <h3>Estructura d'Emmagatzematge a la Imatge</h3>
            <div class="example-box">
                <p><strong>Format de dades a la imatge:</strong></p>
                <div class="code">Bits 0-15:    Longitud del missatge (16 bits, m√†x 65535 car√†cters)
Bits 16-23:   Primer car√†cter encriptat (8 bits)
Bits 24-31:   Segon car√†cter encriptat (8 bits)
...           Car√†cters restants
                
Exemple per "Hola" (4 car√†cters, a=5, b=8):
Bits 0-15:    0000000000000100 (longitud = 4)
Bits 16-23:   01110000 ('H'‚Üí72‚Üí112)
Bits 24-31:   11111101 ('o'‚Üí111‚Üí253)
Bits 32-39:   00011100 ('l'‚Üí108‚Üí28)
Bits 40-47:   10101101 ('a'‚Üí97‚Üí173)</div>
            </div>

            <h3>Per Qu√® el Canal Blau?</h3>
            <p>Codifiquem nom√©s en el canal blau per raons fisiol√≤giques i t√®cniques:</p>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>Sensibilitat ocular:</strong> L'ull hum√† √©s menys sensible als canvis en el blau (cont√© menys cons sensibles al blau)</li>
                <li><strong>Percepci√≥ de luminositat:</strong> El verd contribueix m√©s a la percepci√≥ de luminositat (~59%), el vermell ~30%, i el blau nom√©s ~11%</li>
                <li><strong>Minimitzaci√≥ de distorsi√≥:</strong> Modificar el blau produeix els canvis visuals menys perceptibles</li>
            </ul>

            <h3>Limitacions i Consideracions de Seguretat</h3>
            <ul style="margin-left: 30px; line-height: 2;">
                <li><strong>No √©s criptogr√†ficament segur:</strong> El xifratge af√≠ √©s vulnerable a atacs de freq√º√®ncia i for√ßa bruta</li>
                <li><strong>Detecci√≥ estad√≠stica:</strong> Eines d'estegoan√†lisi poden detectar patrons als LSB modificats</li>
                <li><strong>Format PNG:</strong> Necessari usar PNG (sense p√®rdua) ja que JPEG destruiria les dades als LSB</li>
                <li><strong>Capacitat limitada:</strong> Nom√©s podem emmagatzemar 1 bit per p√≠xel (canal blau), limitant la capacitat</li>
                <li><strong>Recomanaci√≥:</strong> Per dades realment sensibles, combinar amb AES o altres algoritmes moderns abans d'incrustar</li>
            </ul>

            <h3>C√†lcul de Capacitat d'Emmagatzematge</h3>
            <div class="example-box">
                <div class="code">Capacitat = (Amplada √ó Al√ßada √ó 1 bit) / 8 bits per byte

Exemple per imatge 800√ó600:
P√≠xels totals = 800 √ó 600 = 480.000 p√≠xels
Bits disponibles = 480.000 bits (1 per p√≠xel al canal blau)
Bytes disponibles = 480.000 / 8 = 60.000 bytes
                
Descomptant 2 bytes per la longitud:
Capacitat real ‚âà 59.998 car√†cters (molt m√©s que el l√≠mit de 256!)</div>
            </div>

            <h3>Avantatges de la Implementaci√≥</h3>
            <ul style="margin-left: 30px; line-height: 2;">
                <li>‚úì <strong>Execuci√≥ client-side:</strong> Tot el processament es fa al navegador, sense enviar dades a servidors</li>
                <li>‚úì <strong>Par√†metres personalitzables:</strong> L'usuari pot triar els seus propis valors de 'a' i 'b'</li>
                <li>‚úì <strong>Validaci√≥ autom√†tica:</strong> El sistema verifica que els par√†metres siguin matem√†ticament v√†lids</li>
                <li>‚úì <strong>Feedback visual:</strong> Mostra la matriu de p√≠xels abans i despr√©s per prop√≤sits educatius</li>
                <li>‚úì <strong>Compatible amb GitHub Pages:</strong> No requereix backend, funciona completament est√†tic</li>
            </ul>
        </div>

        <div class="tab-content" id="tab-tool">
            <h2>Eina d'Encriptaci√≥ i Desencriptaci√≥</h2>

            <div class="tool-section">
                <h3>üîê Configuraci√≥ d'Encriptaci√≥ Modular</h3>
                <p>Configura els par√†metres per a la f√≥rmula <strong>(a¬∑x + b) mod 256</strong></p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <label for="paramA" style="display: block; font-weight: 600; margin-bottom: 5px;">Multiplicador (a):</label>
                        <input type="number" id="paramA" value="5" min="1" max="255" style="width: 100%;">
                        <small style="color: #666;">Ha de ser senar i coprimer amb 256</small>
                    </div>
                    <div>
                        <label for="paramB" style="display: block; font-weight: 600; margin-bottom: 5px;">Despla√ßament (b):</label>
                        <input type="number" id="paramB" value="8" min="0" max="255" style="width: 100%;">
                        <small style="color: #666;">Qualsevol valor entre 0-255</small>
                    </div>
                </div>
                
                <div id="paramWarning"></div>
                
                <button onclick="testEncryption()" style="background: #28a745;">üß™ Provar Encriptaci√≥</button>
                <div id="testResult"></div>
            </div>

            <div class="tool-section">
                <h3>üîí Encriptar - Amagar un Missatge</h3>
                <p>Puja una imatge PNG i introdueix un missatge secret per amagar-lo.</p>
                
                <div class="upload-area" id="encryptUpload" onclick="document.getElementById('encryptFile').click()">
                    <p style="font-size: 3em; margin-bottom: 10px;">üìÅ</p>
                    <p style="font-size: 1.2em; font-weight: 600;">Fes clic per pujar o arrossega i deixa anar</p>
                    <p style="color: #666;">Nom√©s imatges PNG (m√†x 5MB)</p>
                </div>
                <input type="file" id="encryptFile" accept="image/png">
                
                <div id="encryptImagePreview"></div>
                
                <label for="secretMessage" style="display: block; font-weight: 600; margin-top: 20px;">Missatge Secret:</label>
                <textarea id="secretMessage" placeholder="Introdueix el teu missatge secret aqu√≠ (m√†x 256 car√†cters)" maxlength="256"></textarea>
                <div class="char-limit"><span id="charCount">0</span> / 256 car√†cters</div>
                
                <button id="encryptBtn" onclick="encryptMessage()" disabled>üîí Encriptar i Descarregar</button>
                
                <div id="encryptMessage"></div>
                <div id="encryptPreview"></div>
            </div>

            <div class="tool-section">
                <h3>üîì Desencriptar - Extreure Missatge Amagat</h3>
                <p>Puja una imatge amb un missatge amagat per revelar el seu secret.</p>
                
                <div style="background: #fff3cd; border: 2px solid #ffc107; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <strong>‚ö†Ô∏è Important:</strong> Utilitza els mateixos valors de <strong>a</strong> i <strong>b</strong> que vas utilitzar per encriptar!
                </div>
                
                <div class="upload-area" id="decryptUpload" onclick="document.getElementById('decryptFile').click()">
                    <p style="font-size: 3em; margin-bottom: 10px;">üìÅ</p>
                    <p style="font-size: 1.2em; font-weight: 600;">Fes clic per pujar o arrossega i deixa anar</p>
                    <p style="color: #666;">Nom√©s imatges PNG (m√†x 5MB)</p>
                </div>
                <input type="file" id="decryptFile" accept="image/png">
                
                <div id="decryptImagePreview"></div>
                
                <button id="decryptBtn" onclick="decryptMessage()" disabled>üîì Desencriptar Missatge</button>
                
                <div id="decryptMessage"></div>
                <div id="extractedMessage"></div>
                <div id="decryptPreview"></div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>